![](https://velog.velcdn.com/images/chan9708/post/caea0156-9f8c-4c1b-b6f0-1cfa4f4aa386/image.jpg)

## 1

> **강원도에 위치한 생산공장 목록 출력하기**

```sql
SELECT FACTORY_ID, FACTORY_NAME, ADDRESS
FROM FOOD_FACTORY
WHERE ADDRESS LIKE '강원도%'
ORDER BY FACTORY_ID ASC
```

## 2

> **과일로 만든 아이스크림 고르기**

```sql
SELECT FIRST_HALF.FLAVOR
FROM FIRST_HALF
INNER JOIN ICECREAM_INFO
ON FIRST_HALF.FLAVOR = ICECREAM_INFO.FLAVOR
WHERE FIRST_HALF.TOTAL_ORDER > 3000 AND INGREDIENT_TYPE LIKE 'fruit_based'
ORDER BY FIRST_HALF.TOTAL_ORDER DESC
```

## 3

> **인기있는 아이스크림**

```sql
SELECT FLAVOR
FROM FIRST_HALF
ORDER BY TOTAL_ORDER DESC, SHIPMENT_ID ASC
```

## 4

> **12세 이하인 여자 환자 목록 출력하기**

```sql
SELECT PT_NAME, PT_NO, GEND_CD, AGE,
CASE WHEN TLNO IS NULL THEN 'NONE'
    ELSE TLNO
    END TLNO
FROM PATIENT
WHERE AGE <= 12 AND GEND_CD = 'W'
ORDER BY AGE DESC, PT_NAME ASC
```

## 5

> **흉부외과 또는 일반외과 의사 목록 출력하기**

```sql
SELECT DR_NAME, DR_ID, MCDP_CD, DATE_FORMAT(HIRE_YMD, '%Y-%m-%d') AS HIRE_YMD
FROM DOCTOR
WHERE MCDP_CD = 'CS' OR MCDP_CD = 'GS'
ORDER BY HIRE_YMD DESC, DR_NAME ASC
```

## 6

> **서울에 위치한 식당 목록 출력하기**

```sql
SELECT
A.REST_ID, A.REST_NAME, A.FOOD_TYPE, A.FAVORITES, A.ADDRESS, SCORE
FROM REST_INFO A
RIGHT OUTER JOIN
(SELECT REST_ID, ROUND(AVG(IFNULL(REVIEW_SCORE, 0)) OVER(PARTITION BY REST_ID), 2) AS SCORE
FROM REST_REVIEW) B
ON A.REST_ID = B.REST_ID
WHERE ADDRESS like '서울%'
GROUP BY A.REST_ID, A.REST_NAME, A.FOOD_TYPE, A.FAVORITES, A.ADDRESS, B.SCORE
ORDER BY B.SCORE DESC, A.FAVORITES DESC
```

>

```sql
SELECT
    REST_INFO.REST_ID,
    REST_INFO.REST_NAME,
    REST_INFO.FOOD_TYPE,
    REST_INFO.FAVORITES,
    REST_INFO.ADDRESS,
    ROUND(REVIEW_AVG.AVG_SCORE, 2) AS SCORE
FROM REST_INFO
INNER JOIN (
    SELECT REST_ID, AVG(REVIEW_SCORE) AS AVG_SCORE
    FROM REST_REVIEW
    GROUP BY REST_ID
) AS REVIEW_AVG
ON REVIEW_AVG.REST_ID = REST_INFO.REST_ID
WHERE REST_INFO.ADDRESS LIKE '서울%'
ORDER BY SCORE DESC, FAVORITES DESC
```

## 7

> **3월에 태어난 여성 회원 목록 출력하기**

```sql
SELECT MEMBER_ID, MEMBER_NAME, GENDER,
DATE_FORMAT(DATE_OF_BIRTH, '%Y-%m-%d') AS DATE_OF_BIRTH
FROM MEMBER_PROFILE
WHERE GENDER = 'W'
AND DATE_FORMAT(DATE_OF_BIRTH, '%m') = '03'
AND TLNO IS NOT NULL
```

## 8

> **재구매가 일어난 상품과 회원 리스트 구하기**

```sql
SELECT USER_ID, PRODUCT_ID
FROM ONLINE_SALE
GROUP BY USER_ID, PRODUCT_ID
HAVING COUNT(online_sale_id) > 1
ORDER BY USER_ID ASC, PRODUCT_ID DESC;
```

## 9

> **모든 레코드 조회하기**

```sql
SELECT * FROM ANIMAL_INS
ORDER BY ANIMAL_ID
```

## 10

> **오프라인/온라인 판매 데이터 통합하기**

```sql
SELECT DATE_FORMAT(SALES_DATE, "%Y-%m-%d") AS SALES_DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT
FROM ONLINE_SALE
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 3
UNION ALL
SELECT DATE_FORMAT(SALES_DATE, "%Y-%m-%d") AS SALES_DATE, PRODUCT_ID, NULL AS USER_ID ,SALES_AMOUNT
FROM OFFLINE_SALE
WHERE YEAR(SALES_DATE) = 2022 AND MONTH(SALES_DATE) = 3
ORDER BY SALES_DATE, PRODUCT_ID, USER_ID
```

## 11

> **역순 정렬하기**

```sql
SELECT NAME, DATETIME FROM ANIMAL_INS
ORDER BY ANIMAL_ID DESC
```

## 12

> **아픈 동물 찾기**

```sql
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION = 'Sick'
ORDER BY ANIMAL_ID
```

## 13

> **어린 동물 찾기**

```sql
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
WHERE INTAKE_CONDITION != 'Aged'
ORDER BY ANIMAL_ID
```

## 14

> **동물의 아이디와 이름**

```sql
SELECT ANIMAL_ID, NAME
FROM ANIMAL_INS
ORDER BY ANIMAL_ID
```

## 15

> **여러 기준으로 정렬하기**

```sql
SELECT ANIMAL_ID, NAME, DATETIME
FROM ANIMAL_INS
ORDER BY NAME ASC, DATETIME DESC
```

## 16

> **상위 n개 레코드**

```sql
SELECT NAME
FROM ANIMAL_INS
ORDER BY DATETIME ASC
LIMIT 1
```

## 17

> **조건에 맞는 회원수 구하기**

```sql
SELECT count(USER_ID) AS USERS
FROM USER_INFO
WHERE DATE_FORMAT(JOINED, '%Y') = '2021' AND AGE >= 20 AND AGE <= 29
```

>

```sql
SELECT Count(*) AS USERS FROM USER_INFO WHERE AGE BETWEEN 20 AND 29 AND YEAR(JOINED) = 2021
```
